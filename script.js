document.querySelectorAll("a[href^='#']").forEach(a => { a.addEventListener('click', e => { const id = a.getAttribute('href').slice(1); const el = document.getElementById(id); if (el) { e.preventDefault(); el.scrollIntoView({ behavior: 'smooth', block: 'start' }); } }) }); document.getElementById('y').textContent = new Date().getFullYear(); const form = document.getElementById('orderForm'); const params = new URLSearchParams(location.search); const backend = (params.get('backend') || 'php').toLowerCase(); form.action = backend === 'java' ? form.dataset.actionJava : form.dataset.actionPhp; document.querySelectorAll('[data-product]').forEach(btn => { btn.addEventListener('click', () => { const select = document.getElementById('productSelect'); const val = btn.dataset.product;[...select.options].forEach(o => { if (o.value === val) select.value = val }); document.getElementById('order').scrollIntoView({ behavior: 'smooth' }) }) }); const utm = ['utm_source', 'utm_medium', 'utm_campaign', 'utm_term', 'utm_content'].map(k => params.get(k) ? `${k}=${params.get(k)}` : null).filter(Boolean).join('&'); document.getElementById('utmField').value = utm || document.referrer || 'direct'; const msg = document.getElementById('formMsg'); form.addEventListener('submit', async e => { e.preventDefault(); msg.textContent = 'Надсилаємо...'; try { const fd = new FormData(form); const res = await fetch(form.action, { method: 'POST', body: fd }); const data = await res.json(); if (data.ok) { msg.textContent = 'Дякуємо! Замовлення надіслано.'; form.reset() } else { msg.textContent = data.error || 'Сталася помилка.' } } catch (err) { msg.textContent = 'Помилка мережі.' } });